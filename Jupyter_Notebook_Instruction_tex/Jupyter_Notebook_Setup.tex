\documentclass[12pt]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{mathptmx}                             % The closest font to Times New Roman font in native LaTeX (http://ctan.org/pkg/mathptmx)
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
\geometry{left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm}
%\geometry{landscape}                		% Activate for rotated page geometry
\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{dirtytalk}
\usepackage[inline]{enumitem}
\usepackage{hyperref}
\usepackage{textcomp}                          % Use single quotation \textquotesingle
\hypersetup{backref,pdfpagemode=FullScreen,colorlinks=true,urlcolor=blue}
\usepackage{adjustbox}
\usepackage{multirow}
\usepackage{listings}
%\usepackage{fontspec}
%\setmonofont{Consolas}
%SetFonts
\font\myfont=cmr12 at 10pt 
%SetFonts
\begin{document}

\section*{Jupyter Notebook Set up and Anaconda Installation}

\textbf{Min Chen (\href{chenmi22@msu.edu}{chenmi22@msu.edu}}) \\ 
\textbf{Tong Zhou (\href{zhouton3@msu.edu}{zhouton3@msu.edu}}) \\ 
\textbf{Last updated on May 26, 2019}

The goal of this tutorial is to set up Python program for your research projects. Jupyter Notebook, an interactive environment for python coding, will be used for this purpose. 
There are 3 ways you can run Jupyter Notebook with Python: 1) installing python on your personal computer, 2) run Jupyter Notebook remotely on the icer hpcc, and 3) connecting to the engineering JupyterHub server.

\subsection*{Before you go:}
Check the operating system you use. 

\textbf{Linux:} 

You should be good to skip this section.

\textbf{Macos:} 

Install the xcode command line tools.  You may find it helpful in this link: \href{http://osxdaily.com/2014/02/12/install-command-line-tools-mac-os-x/}{http://osxdaily.com/ 2014/02/12/install-command-line-tools-mac-os-x/}. 

Install homebrew: It is a useful software package manager on macos.  \href{http://osxdaily.com/2018/03/07/how-install-homebrew-mac-os/}{http://osxdaily.com/2018/03/07/how-install-homebrew-mac-os/}

\textbf{Windows10:}

Install the ubuntu-subsystem on your computer. It is fast and safe, with nearly all the features of the ubuntu-linux available. This link may be helpful: \href{https://itsfoss.com/install-bash-on-windows/}{https://itsfoss.com/install-bash-on-windows/}

\subsection*{Option 1: Install python on your personal computer}
\begin{enumerate}[noitemsep]
\item Check your system architecture and python environment. Usually recent computers use x86-64 architecture. Type python in your command line to check your python version.
\item Go to the Anaconda Download webpage \href{https://www.anaconda.com/distribution}{https://www.anaconda.com/distribution}.
\item Choose your operating system (Windows, OS X, or Linux. If using a ubuntu-subsystem in windows10, choose Linux) and download Anaconda suitable for your environment.
Install Anaconda on your computer by double clicking on the package you downloaded and follow the instructions.
\item Open \say{Anaconda-Navigator},  click on \say{Environments} tab and search the relevant packages that are not installed, which includes
obspy, obspyck, obspandas, and geopandas. Select them and then click on the \say{Apply} button. You will also need to install the dependencies of 
geopandas in the way as installing the packages mentioned above. Required dependencies: numpy, pandas (version 0.19.1 or later), shapely (interface to GEOS),
fiona (interface to GDAL), pyproj (interface to PROJ), six. Further, optional dependencies are: rtree 
(optional; spatial index to improve performance and required for overlay operations; interface to libspatialindex), psycopg2 (optional; for PostGIS connection),
geopy (optional; for geocoding). For plotting, these additional packages may be used: matplotlib, descartes, mapclassify.

\item Open the command line program on your computer
\begin{itemize}[noitemsep]
\item On Windows, type CMD in the run box in the start menu.
\item On Mac, type \say{terminal} and hit enter in the Finder window, or double click to open the terminal application in the Utility folder.
\item On Linux, open up a console application.
\end{itemize}
\item Type \say{ipython notebook} or \say{jupyter notebook} in the command line and hit enter.
\end{enumerate}

If everything goes correctly, a browser window should open up with the Jupyter interface running. If things don\textquotesingle t work, don\textquotesingle t worry, we will help you get started.

\subsection*{Option 2: Run Jupyter notebook on the icer hpcc}
MSU hpcc has Linux x86-64 arcitecture and python 2.7 environment by default. To activate the anaconda on the icer hpcc, use this command:
\begin{lstlisting}[language=bash, numbers=left, numberstyle=\tiny,keywordstyle=\color{blue!70},basicstyle=\ttfamily]
module load Anaconda2/4.2.0
\end{lstlisting}
Or you can download the latest anaconda through the official website \href{https://www.anaconda.com/distribution/#download-section}{https://www.anaconda.com/ distribution/#download-section}. Choose the right version (Linux, x86-64, python2.7) Log in to your account, use scp to copy the local installer to your home folder, and then install the anaconda as instructed in option 1.
\begin{lstlisting}[language=bash, numbers=left, numberstyle=\tiny,keywordstyle=\color{blue!70},basicstyle=\ttfamily]
scp local_file usrname@hpcc.msu.edu:remote_folder
\end{lstlisting}
When successfully installed (or activated) anaconda, you may install all the package needed. You may want to create a virtural environment first, and then install jupyter notebook, numpy, obspy, ...
 \begin{lstlisting}[language=bash, numbers=left, numberstyle=\tiny,keywordstyle=\color{blue!70},basicstyle=\ttfamily]
conda create -n environment_name python=3.7
conda install jupyter notebook
conda install numpy
conda install scipy
conda install matplotlib
conda install obspy
...
 \end{lstlisting}
Next step is to set up the port forwarding.

Open a new terminal window, use this command to log in:
\begin{lstlisting}[language=bash, numbers=left, numberstyle=\tiny,keywordstyle=\color{blue!70},basicstyle=\ttfamily]
ssh -L localhost:portnumber1:localhost:portnumber2 usrname@hpcc.msu.edu
 \end{lstlisting}
It established a link that forwards the output of the remote computer from portnumber2 to the local computer on portnumber1. Note: use different portnumber2 between 30000 to 60000 will reduce the chance that you got interference with others. Then use this command to start a jupyter notebook
\begin{lstlisting}[language=bash, numbers=left, numberstyle=\tiny,keywordstyle=\color{blue!70},basicstyle=\ttfamily]
jupyter notebook --no-browser --port=portnumber2
 \end{lstlisting}
Then copy and paste the output URL to your local browser, and change the portnumber2 to portnumber1, you should be all set.

\subsection*{Option 3: Connect to the engineering JupyterHub server}
You can request an engineering computing account. If this is your first time using your Engineering account you will need to activate the account by
going to the following website: 
\begin{center}
\href{https://www.egr.msu.edu/decs/myaccount/?page=activate}{https://www.egr.msu.edu/decs/myaccount/?page=activate} 
\end{center}
Enter your MSU NetID. The initial password will be your APID with an @ at the end (example: A12345678@) and then you have to set a new password that meets the
requirements listed on the page. Verify the password. Then agree to the terms and Activate. \\ \\
Once your account is activated you can access the classroom Jupyterhub server using the following instructions:
\begin{enumerate}[noitemsep]
\item Open up a web browser and go to the URL \href{https://jupyterhub.egr.msu.edu}{https://jupyterhub.egr.msu.edu}.
\item Type your engineering login name, which is your MSU NetID.
\item Enter your engineering password.
\end{enumerate}
If everything is working properly you will see the main \say{Files} windows in the Jupyter interface.


\subsection*{Instructions for getting IPython notebook files into Jupyter}
IPython notebooks, also known as Jupyter notebooks, are files that end with the .ipynb extension. We will give you two example files to work with, you can edit them for your own learning or research 
purpose. Please download the ipynb files from the our GitHub repository by using the following command line: \\\\
\begin{lstlisting}[language=bash, numbers=left, numberstyle=\tiny,keywordstyle=\color{blue!70},basicstyle=\ttfamily]
git clone https://github.com/msu-seismo/python-data-analysis-viz.git
\end{lstlisting}

or visit the website  \href{https://github.com/msu-seismo/python-data-analysis-viz.git}{https://github.com/msu-seismo/python-data-analysis-viz.git} \\\\
You can load the ipynb files in the directory downloaded from our GitHub repository into Jupyter using the
\say{upload} button on the main \say{Files} tab in the Jupyter web interface. Clicking on this button will
cause a file browser window to open. Just navigate to your ipynb file, select it and hit the
open button. Once you see your filename in the Jupyter window you can just click on that
name to start using that file. 

\subsection*{Resources}
I personally recommend Lion Krischer's workshop for you to learn the basic idea of python, from simple a + b to complex signal processing. You can find Lion's ipython notebooks from:

\href{https://github.com/krischer/mess_2019}{https://github.com/krischer/mess\_2019}

You can clone his git to either your own computer or your icer hpcc account by
\begin{lstlisting}[language=bash, numbers=left, numberstyle=\tiny,keywordstyle=\color{blue!70},basicstyle=\ttfamily]
git clone https://github.com/krischer/mess_2019.git
\end{lstlisting}

\end{document}